<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>设置</title>
  <script src="../../shared/theme.js" defer></script>
  <link rel="stylesheet" href="../../shared/styles.css">
  <style>
    /* 设置页面特定样式 */
    .hint {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: var(--space-xs);
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="content-wrapper">
      <!-- 头部 -->
      <div class="header">
        <div class="header-top">
          <h2>设置</h2>
          <div class="header-controls">
            <!-- 下拉菜单按钮 -->
            <div class="dropdown">
              <button id="panelSwitchBtn" class="dropdown-btn">
                <span class="dropdown-arrow">▼</span>
              </button>
              <div id="panelDropdown" class="dropdown-content">
                <a href="#" data-target="pha-panel" class="dropdown-item">👁️ PHA</a>
                <a href="#" data-target="rocket-panel" class="dropdown-item">🚀 Rocket</a>
                <a href="#" data-target="notes-panel" class="dropdown-item">📝 笔记</a>
                <a href="#" data-target="settings-panel" class="dropdown-item active">⚙️ 设置</a>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 主内容 -->
      <div class="inner-pad">
          <!-- 主题设置 -->
          <div class="card" style="display: none;">
            <div class="row">
              <label>主题设置</label>
              <select id="themeSelect">
                <option value="system">跟随系统</option>
                <option value="light">浅色模式</option>
                <option value="dark">深色模式</option>
              </select>
              <div class="hint">选择扩展程序的主题模式，默认为跟随系统设置</div>
            </div>
          </div>

          <!-- 供应商 -->
          <div class="row">
            <div class="card">
              <label>供应商</label>
              <div class="split">
                <select id="vendorSelect"></select>
                <div class="toolbar">
                  <button id="btnAddVendor" class="btn">新增</button>
                  <button id="btnRenameVendor" class="btn">改名</button>
                  <button id="btnDelVendor" class="btn">删</button>
                </div>
              </div>
            </div>
          </div>

          <!-- 供应商参数 -->
          <div class="row grid-2">
            <div class="card">
              <label for="aiBase">URL</label>
              <input id="aiBase" type="text" placeholder="https://api.xxx.com/v1"/>
              <label for="aiKey" style="margin-top:10px">Key</label>
              <input id="aiKey" type="text" placeholder="sk-****"/>
            </div>
            <div class="card">
              <label for="aiVendorPrompt">提示词（供应商）</label>
              <textarea id="aiVendorPrompt" rows="6" placeholder="留空=默认"></textarea>
            </div>
          </div>

          <!-- 模型 -->
          <div class="row card">
            <label>模型</label>
            <div class="split">
              <select id="modelSelect"></select>
              <div class="toolbar">
                <button id="btnAddModel" class="btn">新增</button>
                <button id="btnRenameModel" class="btn">改名</button>
                <button id="btnDelModel" class="btn">删</button>
              </div>
            </div>
          </div>

          <!-- 模型参数 -->
          <div class="row grid-2">
            <div class="card">
              <label for="aiModel">模型ID</label>
              <input id="aiModel" type="text" placeholder="deepseek-chat"/>
              <div class="status" style="margin-top:6px">仅名称，不含路径</div>
            </div>
            <div class="card">
              <label for="modelPrompt">提示词（模型）</label>
              <textarea id="modelPrompt" rows="6" placeholder="留空=继承供应商"></textarea>
            </div>
          </div>

        <!-- 导入导出 / 保存 -->
        <div class="row right-actions">
          <div style="display:flex;gap:var(--space-md);align-items:center">
            <button id="btnExport" class="btn" title="导出配置与历史Post">导出</button>
            <input id="importFile" type="file" accept="application/json" style="display:none"/>
            <button id="btnImport" class="btn" title="导入配置与历史Post">导入</button>
            <span id="importExportStatus" class="status"></span>
          </div>
          <div style="display:flex;gap:var(--space-md)">
            <button id="btnReset" class="btn">重置</button>
            <button id="btnSave" class="btn btn-primary">保存</button>
          </div>
        </div>
        
        <!-- 存储空间使用情况 -->
        <div class="row" style="margin-top:16px;">
          <div class="card">
            <label style="margin-bottom:4px;">存储空间使用情况</label>
            <div id="storageUsage" class="status">加载中...</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 隐藏的侧边栏导航，保留以确保rail.js的功能正常 -->
  <nav class="rail" aria-label="面板切换" style="display: none;">
    <button class="railbtn" data-target="pha-panel" title="PHA" aria-label="PHA">👁️</button>
    <button class="railbtn" data-target="rocket-panel" title="Rocket" aria-label="Rocket">🚀</button>
    <button class="railbtn" data-target="notes-panel" title="笔记" aria-label="笔记">📝</button>
    <button class="railbtn active" data-target="settings-panel" title="设置" aria-label="设置">⚙️</button>
  </nav>

  <script type="module" src="../persist-init.js"></script>
  <script defer src="./settings.js"></script>
  <script defer src="../../rail.js"></script>
  <script defer src="../../shared/dropdown-menu.js"></script>
</body>
</html>
